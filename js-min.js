let apiKey = "fafece6730fe406d84212124210405", baseUrl = "http://api.weatherapi.com/v1", mainDay = document.querySelector(".day"), mainDate = document.querySelector(".date"), city = document.querySelector(".city-name"), mainTemp = document.querySelector(".temp-update"), mainIcon = document.querySelector(".time-icon img"), mainState = document.querySelector(".state p"), hum = document.querySelector(".hum-update"), cloud = document.querySelector(".cloud-update"), wind = document.querySelector(".wind-update"), highTemp = document.querySelectorAll(".high-temp span"), forecastDay = document.querySelectorAll(".forecast-day"), lowTemp = document.querySelectorAll(".low-temp span"), forecastIcon = document.querySelectorAll(".forecast-icon img"), forecastState = document.querySelectorAll(".forecast-state p"), search = document.querySelector("#search"), starBtn = document.querySelector(".star-btn"), starP = document.querySelector(".star"), flag = document.querySelector(".flag"), starBtnI = document.querySelector(".star-btn i"), bulb = document.querySelector(".fixed-bulb"), bulbI = document.querySelector(".fixed-bulb i"), dayNum = 0, errorFetch = document.querySelector(".error"); async function mainFunc(e) { let t = await fetch(`${baseUrl}/forecast.json?key=${apiKey}&q=${e}&days=7`), a = await t.json(); 1 == a.hasOwnProperty("error") ? danger() : (errorFetch.classList.add("error"), search.classList.add("good"), search.classList.remove("bad"), display(a), getFlag(a.location.country)), starBtn.addEventListener("click", () => { localStorage.setItem("starred", a.location.name), localStorage.setItem("country", a.location.country), starBtnI.style.color = "var(--main)", starBtnI.style.fontSize = "23px", starP.innerHTML = `<i class="fas fa-map-marker-alt px-1"></i>  ${a.location.name}` }) } async function defaultFunc() { null != localStorage.getItem("starred") ? (mainFunc(localStorage.getItem("starred")), starP.innerHTML = `<i class="fas fa-map-marker-alt px-1"></i>  ${localStorage.getItem("starred")}`) : mainFunc("paris") } function display(e) { city.innerText = e.location.name, mainState.innerText = e.current.condition.text, mainTemp.innerText = e.current.temp_c, hum.innerText = e.current.humidity, cloud.innerText = e.current.cloud, wind.innerText = e.current.wind_kph, mainIcon.src = `http:${e.current.condition.icon}`; let t = e.forecast.forecastday; for (let e = 1; e < t.length; e++)highTemp[e - 1].innerText = t[e].day.maxtemp_c, lowTemp[e - 1].innerText = t[e].day.mintemp_c, forecastState[e - 1].innerText = t[e].day.condition.text, forecastIcon[e - 1].src = `http:${t[e].day.condition.icon}`; mydate(e) } function mydate(e) { var t = new Date, a = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"], r = e.location.localtime; let n = parseInt(r.slice(8, 10)); t.getDate() == n ? (dayNum = t.getDay(), mainDay.innerText = a[dayNum]) : t.getDate() > n ? (dayNum = t.getDay() - 1) < 0 ? (dayNum = 6, mainDay.innerText = a[dayNum]) : mainDay.innerText = a[dayNum] : t.getDate() < n && ((dayNum = t.getDay() + 1) > 6 ? (dayNum = 0, mainDay.innerText = a[dayNum]) : mainDay.innerText = a[dayNum]), mainDate.innerText = `${["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"][t.getMonth()]} ${n}`; for (let e = 0; e < forecastDay.length; e++)forecastDay[e].innerText = a[dayNum + e + 1] } async function getFlag(e) { if ("United States of America" == e) flag.src = "https://upload.wikimedia.org/wikipedia/en/a/a4/Flag_of_the_United_States.svg"; else { let t = await fetch("https://countriesnow.space/api/v0.1/countries/flag/images"), a = await t.json(); for (let t = 0; t < a.data.length; t++)a.data[t].name == e && (flag.src = a.data[t].flag) } } function danger() { search.classList.add("bad"), errorFetch.innerText = `${search.value} is not a city name`, errorFetch.classList.remove("error"), search.classList.remove("good") } search.addEventListener("keyup", () => { starBtnI.style.color = "rgba(58, 58, 60, 0.527)", starBtnI.style.fontSize = "22px"; let e = search.value; if (e.length > 2) { mainFunc(e.split(" ").join("_")) } }), bulb.addEventListener("click", e => { "far" == e.target.classList[0] ? (bulb.innerHTML = '<i class="fas fa-lightbulb on">', document.body.style.setProperty("--text", "rgb(26,25,26)"), document.body.style.setProperty("--body", "#f2f2f7"), document.body.style.setProperty("--date", "#A6A6A6"), document.body.style.setProperty("--bg", " rgba(255, 255, 255, 0.319)"), document.body.style.setProperty("--item", " rgb(238,238,238)")) : (bulb.innerHTML = '<i class="far fa-lightbulb off">', document.body.style.setProperty("--text", "#fff"), document.body.style.setProperty("--body", "rgb(26,25,26)"), document.body.style.setProperty("--date", "rgb(58,58,60)"), document.body.style.setProperty("--item", "rgb(44,44,46)"), document.body.style.setProperty("--bg", "rgba(26, 25, 26, 0.719)")) }), defaultFunc();